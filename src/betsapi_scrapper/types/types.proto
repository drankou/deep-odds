syntax = "proto3";

import "github.com/gogo/protobuf/gogoproto/gogo.proto";
option go_package = ".;types";

service Betsapi {
    rpc GetInPlayEvents (InPlayEventsRequest) returns (stream Event) {
    }

    rpc GetUpcomingEvents (UpcomingEventsRequest) returns (stream Event) {
    }

    rpc GetStartingEvents (StartingEventsRequest) returns (stream Event) {
    }

    rpc GetEndedEvents (EndedEventsRequest) returns (stream Event) {
    }

    rpc GetEventView (EventViewRequest) returns (Event) {
    }

    rpc GetEventHistory (EventHistoryRequest) returns (EventHistory) {
    }

    rpc GetEventOdds (EventOddsRequest) returns (Odds) {
    }

    rpc GetEventStatsTrend (EventStatsTrendRequest) returns (StatsTrend) {
    }

    rpc GetLeagues (LeaguesRequest) returns (stream League) {
    }

    rpc GetTeams (TeamsRequest) returns (stream Team) {
    }
}

message LeaguesRequest {
    string sport_id = 1;
    string country_code = 2;
    string page = 3;
}

message TeamsRequest {
    string sport_id = 1;
    string page = 2;
}

message InPlayEventsRequest {
    string sport_id = 1;
}

message UpcomingEventsRequest {
    string sport_id = 1;
    string league_id = 2;
    string team_id = 3;
    string country_code = 4;
    string day = 5;
    string page = 6;
}

message StartingEventsRequest {
    string sport_id = 1;
    int64 minute_threshold = 2;
}

message EndedEventsRequest {
    string sport_id = 1;
    string league_id = 2;
    string team_id = 3;
    string country_code = 4;
    string day = 5;
    string page = 6;
}

message EventViewRequest {
    string event_id = 1;
}

message EventOddsRequest {
    //Event id
    string event_id = 1;
    //odds source, name of available bookmakers
    string source = 2;
    //add_time will be >= $since_time in results. Faster to get only updates
    int64 since_time = 3;
    //if you only need one (or few) market to save time/bandwidth, pass the related string like &odds_market=1 or &odds_market=2,3 etc.
    string odds_market = 4;
}

message EventStatsTrendRequest {
    string event_id = 1;
}

// ------------- Event ---------------- //
message Event {
    string id = 1 [(gogoproto.jsontag) = "id", (gogoproto.moretags) = "bson:\"id,omitempty\""];
    int64 time = 2 [(gogoproto.jsontag) = "time,string", (gogoproto.moretags) = "bson:\"time,omitempty\""];
    string sport_id = 3 [(gogoproto.jsontag) = "sport_id", (gogoproto.moretags) = "bson:\"sport_id,omitempty\""];
    string time_status = 4 [(gogoproto.jsontag) = "time_status", (gogoproto.moretags) = "bson:\"time_status,omitempty\""];
    string score = 5 [(gogoproto.jsontag) = "ss", (gogoproto.moretags) = "bson:\"score,omitempty\""];
    Team home_team = 6 [(gogoproto.jsontag) = "home", (gogoproto.moretags) = "bson:\"home_team,omitempty\""];
    Team away_team = 7 [(gogoproto.jsontag) = "away", (gogoproto.moretags) = "bson:\"away_team,omitempty\""];
    League league = 8 [(gogoproto.jsontag) = "league", (gogoproto.moretags) = "bson:\"league,omitempty\""];
    Timer timer = 9 [(gogoproto.jsontag) = "timer", (gogoproto.moretags) = "bson:\"-\""];
    ExtraInfo extra_info = 10 [(gogoproto.jsontag) = "extra,omitempty", (gogoproto.moretags) = "bson:\"extra_info,omitempty\""];
    repeated EventViewEvent events = 11 [(gogoproto.jsontag) = "events,omitempty", (gogoproto.moretags) = "bson:\"events,omitempty\""];
    int32 has_lineup = 12 [(gogoproto.jsontag) = "has_lineup,omitempty", (gogoproto.moretags) = "bson:\"has_lineup,omitempty\""];
}

message Team {
    string id = 1 [(gogoproto.jsontag) = "id", (gogoproto.moretags) = "bson:\"id,omitempty\""];
    string name = 2 [(gogoproto.jsontag) = "name", (gogoproto.moretags) = "bson:\"name,omitempty\""];
    string country_code = 3 [(gogoproto.jsontag) = "cc", (gogoproto.moretags) = "bson:\"country_code,omitempty\""];
}

message League {
    string id = 1 [(gogoproto.jsontag) = "id", (gogoproto.moretags) = "bson:\"id,omitempty\""];
    string name = 2 [(gogoproto.jsontag) = "name", (gogoproto.moretags) = "bson:\"name,omitempty\""];
    string country_code = 3 [(gogoproto.jsontag) = "cc", (gogoproto.moretags) = "bson:\"country_code,omitempty\""];
}

message Timer {
    int64 active = 1 [(gogoproto.jsontag) = "tt,string", (gogoproto.moretags) = "bson:\"-\""];
    int64 minutes = 2 [(gogoproto.jsontag) = "tm", (gogoproto.moretags) = "bson:\"minutes,omitempty\""];
    int64 seconds = 3 [(gogoproto.jsontag) = "ts", (gogoproto.moretags) = "bson:\"seconds,omitempty\""];
    int64 added_time = 4 [(gogoproto.jsontag) = "ta", (gogoproto.moretags) = "bson:\"added_time,omitempty\""];
}

message ExtraInfo {
    Manager home_manager = 1 [(gogoproto.moretags) = "bson:\"home_manager,omitempty\""];
    Manager away_manager = 2 [(gogoproto.moretags) = "bson:\"away_manager,omitempty\""];
    Referee referee = 3 [(gogoproto.moretags) = "bson:\"referee,omitempty\""];
    StadiumData stadium_data = 4 [(gogoproto.moretags) = "bson:\"stadium_data,omitempty\""];
    int64 length = 5 [(gogoproto.jsontag) = "length,string", (gogoproto.moretags) = "bson:\"length,omitempty\""];
    string pitch = 6 [(gogoproto.moretags) = "bson:\"pitch,omitempty\""];
    string weather = 7 [(gogoproto.moretags) = "bson:\"weather,omitempty\""];
    string stadium = 8 [(gogoproto.moretags) = "bson:\"stadium,omitempty\""];
    int64 home_position = 9 [(gogoproto.moretags) = "bson:\"home_pos,omitempty\""];
    int64 away_position = 10 [(gogoproto.moretags) = "bson:\"away_pos,omitempty\""];
    string round = 11 [(gogoproto.moretags) = "bson:\"round,omitempty\""];
}

message Manager {
    string name = 1 [(gogoproto.jsontag) = "name", (gogoproto.moretags) = "bson:\"name,omitempty\""];
    string country_code = 2 [(gogoproto.jsontag) = "cc", (gogoproto.moretags) = "bson:\"country_code,omitempty\""];
}

message Referee {
    string name = 1;
    string country_code = 2 [(gogoproto.jsontag) = "cc", (gogoproto.moretags) = "bson:\"country_code,omitempty\""];
}

message StadiumData {
    string id = 1 [(gogoproto.jsontag) = "id", (gogoproto.moretags) = "bson:\"id,omitempty\""];
    string name = 2 [(gogoproto.jsontag) = "name", (gogoproto.moretags) = "bson:\"name,omitempty\""];
    string city = 3 [(gogoproto.jsontag) = "city", (gogoproto.moretags) = "bson:\"city,omitempty\""];
    string country = 4 [(gogoproto.jsontag) = "country", (gogoproto.moretags) = "bson:\"country,omitempty\""];
    int64 capacity = 5 [(gogoproto.jsontag) = "capacity,string,omitempty", (gogoproto.moretags) = "bson:\"capacity,omitempty\""];
    string google_coords = 6 [(gogoproto.jsontag) = "googlecoords,omitempty", (gogoproto.moretags) = "bson:\"googlecoords,omitempty\""];
}

message EventViewEvent {
    string id = 1 [(gogoproto.jsontag) = "id", (gogoproto.moretags) = "bson:\"-\""];
    string text = 2 [(gogoproto.jsontag) = "text", (gogoproto.moretags) = "bson:\"text,omitempty\""];
}
// ----------------------------

message EventHistoryRequest {
    string event_id = 1;
    string qty = 2;
}

message EventHistory {
    repeated Event h2h = 1;
    repeated Event home = 2;
    repeated Event away = 3;
}

// ----------- Odds ------------- //
message Odds {
    repeated Result full_time = 1 [(gogoproto.jsontag) = "1_1", (gogoproto.moretags) = "bson:\"full_time\""];
    repeated AsianHandicapResult asian_handicap = 2 [(gogoproto.jsontag) = "1_2", (gogoproto.moretags) = "bson:\"asian_handicap\""];
    repeated AsianHandicapTotal total = 3 [(gogoproto.jsontag) = "1_3", (gogoproto.moretags) = "bson:\"total\""];
    repeated AsianHandicapTotal asian_corners = 4 [(gogoproto.jsontag) = "1_4", (gogoproto.moretags) = "bson:\"asian_corners\""];
    repeated AsianHandicapResult first_half_asian_handicap = 5 [(gogoproto.jsontag) = "1_5", (gogoproto.moretags) = "bson:\"first_half_asian_handicap\""];
    repeated AsianHandicapTotal first_half_total = 6 [(gogoproto.jsontag) = "1_6", (gogoproto.moretags) = "bson:\"first_half_total\""];
    repeated AsianHandicapTotal first_half_asian_corners = 7 [(gogoproto.jsontag) = "1_7", (gogoproto.moretags) = "bson:\"first_half_asian_corners\""];
    repeated Result first_half = 8 [(gogoproto.jsontag) = "1_8", (gogoproto.moretags) = "bson:\"first_half\""];
}

message Result {
    string id = 1 [(gogoproto.jsontag) = "id", (gogoproto.moretags) = "bson:\"-\""];
    double home_odds = 2 [(gogoproto.jsontag) = "home_od,string", (gogoproto.moretags) = "bson:\"home_odds\""];
    double draw_odds = 3 [(gogoproto.jsontag) = "draw_od,string", (gogoproto.moretags) = "bson:\"draw_odds\""];
    double away_odds = 4 [(gogoproto.jsontag) = "away_od,string", (gogoproto.moretags) = "bson:\"away_odds\""];
    string score = 5 [(gogoproto.jsontag) = "ss", (gogoproto.moretags) = "bson:\"score\""];
    int64 minute = 6 [(gogoproto.jsontag) = "time_str,string", (gogoproto.moretags) = "bson:\"minute\""];
    int64 add_time = 7 [(gogoproto.jsontag) = "add_time,string", (gogoproto.moretags) = "bson:\"add_time\""];
}

message AsianHandicapResult {
    string id = 1 [(gogoproto.jsontag) = "id", (gogoproto.moretags) = "bson:\"-\""];
    double home_odds = 2 [(gogoproto.jsontag) = "home_od,string", (gogoproto.moretags) = "bson:\"home_odds\""];
    string handicap = 3 [(gogoproto.jsontag) = "handicap", (gogoproto.moretags) = "bson:\"handicap\""];
    double away_odds = 4 [(gogoproto.jsontag) = "away_od,string", (gogoproto.moretags) = "bson:\"away_odds\""];
    string score = 5 [(gogoproto.jsontag) = "ss", (gogoproto.moretags) = "bson:\"score\""];
    int64 minute = 6 [(gogoproto.jsontag) = "time_str,string", (gogoproto.moretags) = "bson:\"minute\""];
    int64 add_time = 7 [(gogoproto.jsontag) = "add_time,string", (gogoproto.moretags) = "bson:\"add_time\""];
}

message AsianHandicapTotal {
    string id = 1 [(gogoproto.jsontag) = "id", (gogoproto.moretags) = "bson:\"-\""];
    double over_odds = 2 [(gogoproto.jsontag) = "over_od,string", (gogoproto.moretags) = "bson:\"home_odds\""];
    string handicap = 3 [(gogoproto.jsontag) = "handicap", (gogoproto.moretags) = "bson:\"handicap\""];
    double under_odds = 4 [(gogoproto.jsontag) = "under_od,string", (gogoproto.moretags) = "bson:\"away_odds\""];
    string score = 5 [(gogoproto.jsontag) = "ss", (gogoproto.moretags) = "bson:\"score\""];
    int64 minute = 6 [(gogoproto.jsontag) = "time_str,string", (gogoproto.moretags) = "bson:\"minute\""];
    int64 add_time = 7 [(gogoproto.jsontag) = "add_time,string", (gogoproto.moretags) = "bson:\"add_time\""];
}
// ----------------------------

// ------------------ Stats trend ----------------- //
message StatsTrend {
    StatsTrendValue attacks = 1 [(gogoproto.jsontag) = "attacks", (gogoproto.moretags) = "bson:\"attacks\""];
    StatsTrendValue dangerous_attacks = 2 [(gogoproto.jsontag) = "dangerous_attacks", (gogoproto.moretags) = "bson:\"dangerous_attacks\""];
    StatsTrendValue possession = 3 [(gogoproto.jsontag) = "possession", (gogoproto.moretags) = "bson:\"possession\""];
    StatsTrendValue off_target = 4 [(gogoproto.jsontag) = "off_target", (gogoproto.moretags) = "bson:\"off_target\""];
    StatsTrendValue on_target = 5 [(gogoproto.jsontag) = "on_target", (gogoproto.moretags) = "bson:\"on_target\""];
    StatsTrendValue corners = 6 [(gogoproto.jsontag) = "corners", (gogoproto.moretags) = "bson:\"corners\""];
    StatsTrendValue goals = 7 [(gogoproto.jsontag) = "goals", (gogoproto.moretags) = "bson:\"goals\""];
    StatsTrendValue yellow_cards = 8 [(gogoproto.jsontag) = "yellowcards", (gogoproto.moretags) = "bson:\"yellow_cards\""];
    StatsTrendValue red_cards = 9 [(gogoproto.jsontag) = "redcards", (gogoproto.moretags) = "bson:\"redcards\""];
    StatsTrendValue substitutions = 10 [(gogoproto.jsontag) = "substitutions", (gogoproto.moretags) = "bson:\"substitutions\""];
}

message StatsTrendValue {
    repeated StatsTrendTick home = 1 [(gogoproto.jsontag) = "home", (gogoproto.moretags) = "bson:\"home\""];
    repeated StatsTrendTick away = 2 [(gogoproto.jsontag) = "away", (gogoproto.moretags) = "bson:\"away\""];
}

message StatsTrendTick {
    int64 time = 1 [(gogoproto.jsontag) = "time_str,string", (gogoproto.moretags) = "bson:\"time\""];
    int64 value = 2 [(gogoproto.jsontag) = "val,string", (gogoproto.moretags) = "bson:\"value\""];
}

message FootballEvent {
    Event event = 1;
    EventHistory history = 2;
    Odds odds = 3;
    StatsTrend stats_trend = 4;
}
